<mat-sidenav-container class="sidebar-container" (backdropClick)="close()">
    <mat-sidenav #sidenav (keydown.escape)="close()" position="end" disableClose>
        <app-add-comment-report (closePanel)="close()"></app-add-comment-report>
    </mat-sidenav>
    <mat-sidenav-content>
        <div id="admin-container">
            <div id="admin-main" class="bg-background">
                <app-nav-top>
                    <div class="nav-option"><span>USERS</span></div>
                    <div class="nav-option"><span>CENTERS</span></div>
                    <div [routerLink]="'../projects'" class="nav-option"><span>PROJECTS</span></div>
                    <div class="nav-option"><span>INCIDENTS</span></div>
                </app-nav-top>
                <div class="container color-black">
                    <form class="example-form">
                        <div class="header-page">
                            <div class="title-page">
                                <span>INCIDENTS</span>
                            </div>
                            <div class="contaner-filters">
                                <div class="filters">
                                    <select class="filter" name="status" [(ngModel)]="filters.status">
                                        <option selected [value]="null">ALL STATUSES</option>
                                        <option *ngFor="let status of statuses" [value]="status.id">
                                            {{ status.r_status_txt | uppercase }}
                                        </option>
                                    </select>
                                    <select class="filter" name="types" [(ngModel)]="filters.types">
                                        <option selected [value]="null">ALL TYPES</option>
                                        <option *ngFor="let type of types" [value]="type.id">
                                            {{ type.q_option_title | uppercase }}
                                        </option>
                                    </select>
                                    <select class="filter" name="centers" [(ngModel)]="filters.centers">
                                        <option selected [value]="null">ALL CENTERS</option>
                                        <option *ngFor="let center of centers" [value]="center.id">
                                            {{ center.center_name | uppercase }}
                                        </option>
                                    </select>
                                    <select class="filter" name="project" [(ngModel)]="filters.project">
                                        <option selected [value]="null">ALL PROJECTS</option>
                                        <option *ngFor="let project of projects" [value]="project.id">
                                            {{ project.proj_name | uppercase }}
                                        </option>
                                    </select>
                                    <input class="filter" type="text" placeholder="SEARCH"/>
                                </div>
                            </div>
                            <div>
                                <button type="button" class="btn-add bg-green-dark">ADD INCIDENT</button>
                            </div>
                        </div>
                    </form>
                    <section class="table-container mat-elevation-z8" tabindex="0">
                        <table mat-table [dataSource]="dataSource">
                            <ng-container matColumnDef="status">
                                <th mat-header-cell *matHeaderCellDef>STATUS</th>
                                <td (click)="sidenav.open(); showDetails(element.id)" mat-cell *matCellDef="let element"><span class="bg-yellow">{{element.status}}</span></td>
                            </ng-container>
                            <ng-container matColumnDef="incidentType">
                                <th mat-header-cell *matHeaderCellDef>INCIDENT TYPE</th>
                                <td (click)="sidenav.open(); showDetails(element.id)" mat-cell *matCellDef="let element"><span class="bg-orange">{{element.incidentType}}</span></td>
                            </ng-container>
                            <ng-container matColumnDef="date">
                                <th mat-header-cell *matHeaderCellDef>DATE</th>
                                <td class="text-center" (click)="sidenav.open(); showDetails(element.id)" mat-cell *matCellDef="let element"> {{element.date | date: 'mediumDate' }} </td>
                            </ng-container>
                            <ng-container matColumnDef="project">
                                <th mat-header-cell *matHeaderCellDef>PROJECT</th>
                                <td (click)="sidenav.open(); showDetails(element.id)" mat-cell *matCellDef="let element"> {{element.project}} </td>
                            </ng-container>
                            <ng-container matColumnDef="incident">
                                <th mat-header-cell *matHeaderCellDef style="min-width: 300px;">INCIDENT</th>
                                <td (click)="sidenav.open(); showDetails(element.id)" mat-cell *matCellDef="let element"> {{element.incident}} </td>
                            </ng-container>
                            <ng-container matColumnDef="assign">
                                <th mat-header-cell *matHeaderCellDef>ASSIGN</th>
                                <td class="text-center" mat-cell *matCellDef="let element" (click)="sidenav.open(); showDetails(element.id)">
                                    <ng-container *ngFor="let assing of element.assigns">
                                        <span class="img-text">{{assing.value_initials | uppercase}}</span>
                                    </ng-container>

                                    <!-- <div *ngIf="item[head.list].length > 2" class="box-img box-imgg-asset" >
                                        <div (mouseleave)="_gS.hidemenu()" (mouseenter)="onClickUser($event, item)">
                                            <span>+{{item[head.list].length - 2}}</span>
                                        </div>
                                    </div> -->
                                </td>
                                </ng-container>
                            <ng-container matColumnDef="comments">
                                <th mat-header-cell *matHeaderCellDef>COMMENTS</th>
                                <td class="commets" mat-cell *matCellDef="let element" (click)="sidenav.open(); showDetails(element.id)">
                                    <mat-icon aria-hidden="false" aria-label="comments">forum</mat-icon>
                                    <span>{{element.comments ? element.comments.length : 0}}</span>
                                </td>
                            </ng-container>
                            <ng-container matColumnDef="id">
                                <th mat-header-cell *matHeaderCellDef></th>
                                <td mat-cell *matCellDef="let element; let i = index">
                                    <div class="btn-option">
                                        <button class="bg-background" (click)="replyIncident(element.id)">
                                            REPLY
                                        </button>
                                    </div>
                                    <div class="btn-option">
                                        <button class="bg-green-dark" (click)="closeIncident(element.id)">
                                            CLOSE
                                        </button>
                                    </div>
                                </td>
                            </ng-container>
                            <tr mat-header-row *matHeaderRowDef="displayedColumns; sticky: true"></tr>
                            <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
                        </table>
                    </section>
                </div>
            </div>
        </div>
        <footer id="footer" class="bg-footer">
            <div class="footer">
                <h3 class="color-title-footer">LEGAL TERMS | DATA POLICY</h3>
                <p>COPYRIGHT Â© 2022 GRUPO CINCOVEINTICINCO SAS. ALL RIGTHS RESERVED</p>
            </div>
        </footer>
    </mat-sidenav-content>
</mat-sidenav-container>
